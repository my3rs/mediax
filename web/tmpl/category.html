{{ define "main" }}
<main>
    <div class="page-heading"> 
        {{ if eq .Header.Current "book" }}
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="28" fill="currentColor"><path d="M23 5v13.883l-1 .117v-16c-3.895.119-7.505.762-10.002 2.316-2.496-1.554-6.102-2.197-9.998-2.316v16l-1-.117v-13.883h-1v15h9.057c1.479 0 1.641 1 2.941 1 1.304 0 1.461-1 2.942-1h9.06v-15h-1zm-12 13.645c-1.946-.772-4.137-1.269-7-1.484v-12.051c2.352.197 4.996.675 7 1.922v11.613zm9-1.484c-2.863.215-5.054.712-7 1.484v-11.613c2.004-1.247 4.648-1.725 7-1.922v12.051z"/></svg>
        {{ else if eq .Header.Current "movie" }}
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="28" fill="currentColor"><path d="M13.112 6L16 2.625 15.219 2 12 5.75 8.781 2 8 2.625 10.888 6H0v16h24V6H13.112zM21 20H3V8h18v12zM9 18v-8l7 4-7 4z"/></svg>
        {{ else if eq .Header.Current "tv" }}
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="28" fill="currentColor"><path d="M13.112 6L16 2.625 15.219 2 12 5.75 8.781 2 8 2.625 10.888 6H0v16h24V6H13.112zM21 20H3V8h18v12zM6.164 11h5.673v1.418h-2.01V17H8.174v-4.582h-2.01V11zm9.961 0l-1.158 3.653L13.816 11h-1.701l1.942 6h1.792l1.986-6h-1.71z"/></svg>
        {{ else if eq .Header.Current "anime" }}
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="28" fill="currentColor"><path d="M13.112 6L16 2.625 15.219 2 12 5.75 8.781 2 8 2.625 10.888 6H0v16h24V6H13.112zM21 20H3V8h18v12zM8 11.5a1.8 1.8 0 1 0 0 3.6 1.8 1.8 0 0 0 0-3.6zm8 0a1.8 1.8 0 1 0 0 3.6 1.8 1.8 0 0 0 0-3.6z"/></svg>
        {{ else if eq .Header.Current "game" }}
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="28" fill="currentColor"><path d="M17.622 3c-1.913 0-2.558 1.382-5.623 1.382C8.99 4.382 8.253 3 6.376 3 1.167 3 0 13.375 0 17.348 0 19.493.817 21 2.469 21c3.458 0 2.926-5 6.915-5h5.23c3.989 0 3.457 5 6.915 5C23.181 21 24 19.494 24 17.349 24 13.376 22.831 3 17.622 3zM7 13a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm10-6a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm-2 4a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm2 2a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm2-2a1 1 0 1 1 0-2 1 1 0 0 1 0 2zM8.75 10c0 .965-.785 1.75-1.75 1.75S5.25 10.965 5.25 10 6.035 8.25 7 8.25s1.75.785 1.75 1.75z"/></svg>
        {{ end }}
        <h1>{{ .PageTitle }} ({{ .TotalCounts }})</h1>
    </div>

    {{ if ne .TotalCounts 0 }}
    <div class="page-toolbar">
        <div class="page-filter">
            {{ range .StatusList }}
                {{ if ne .Count 0 }}
                <li><a href="/{{ $.Header.Current }}?status={{ .Value }}" class="{{ if eq $.Status .Value }}active{{ end }}">{{ .Label }}({{ .Count }})</a>
                </li>
                {{ end }}
            {{ end }}
        </div>
        <div class="page-func">
            <form method="get">
                <label for="sort_by">排序: </label>
                <select class="sort-select" name="sort_by" onchange="this.form.submit()">
                    <option value="1"{{ if eq .SortBy 1 }} selected{{ end }}>最近添加</option>
                    <option value="2"{{ if eq .SortBy 2 }} selected{{ end }}>最近标记</option>
                    <option value="3"{{ if eq .SortBy 3 }} selected{{ end }}>最早添加</option>
                    <option value="4"{{ if eq .SortBy 4 }} selected{{ end }}>最早标记</option>
                </select>
                <input type="hidden" name="page"  value="{{ .CurrentPage }}">
                <input type="hidden" name="status" value="{{ .Status }}">
            </form>
            <a href="/add?subject_type={{ .Header.Current }}" title="添加">添加{{ .PageTitle }}+</a>
        </div>
    </div>

    <ul class="subject-list">
        {{ range .Subjects }}
        <li>
            <a class="subject-list-cover" href="{{ .SubjectURL }}">
                <img class="subject-list-image" src="{{ .ImageURL }}" alt="{{ .Title }}" loading="lazy">
            </a>
            <div class="subject-list-info">
                <h3 class="subject-list-title">
                    <a href="{{ .SubjectURL }}">{{ .Title }}</a>
                    {{ with .AltTitle }}
                    <span class="note-color subject-list-alttitle">{{ . }}</span>
                    {{ end }}
                </h3>
                {{ if .Creator }}
                <p class="subject-list-pub"><label>{{ .CreatorLabel }}:</label>{{ .Creator }}</p>
                {{ end }}
                {{ if .PubDate }}
                <p><label>{{ .PubDateLabel }}:</label>{{ .PubDate }}</p>
                {{ end }}
                <p class="note-color">
                    {{ if eq .Rating 0 }}
                    <i>暂未评分</i>
                    {{ else }}
                    {{ $star := div (mul .Rating 10) 2 }}
                    <span class="rating-star-{{ $star }} rating-block note-color"></span>
                    {{ end }}
                </p>
                <p>{{ .MarkDate }} {{ .StatusText }}</p>
            </div>
        </li>
        {{ end }}
    </ul>
    {{ else }}
    <div class="subject-list-null note-color">
        <i>伟大的冒险，总是从一片空白开始。</i>
        <p><a href="/add?subject_type={{ .Header.Current }}" title="添加">添加{{ .PageTitle }} (ง •̀_•́)ง</a></p>
    </div>
    {{ end }}

    {{ if gt .TotalPages 1 }}
    <div class="page-nav">
        <div class="pagination">
            {{ if gt .CurrentPage 1 }}
            <a class="pagination-number padding-0" href="?page=1{{ .PageParams }}">首页</a>
            <a class="pagination-number" href="?page={{ sub .CurrentPage 1 }}{{ .PageParams }}">
                <svg xmlns="http://www.w3.org/2000/svg" width="8" viewBox="0 0 8 12" fill="currentColor"><path d="M7.41 1.41L6 0 0 6l6 6 1.41-1.41L2.83 6z" fill-rule="evenodd"/></svg>
            </a>
            {{ else }}
            <span class="pagination-disable padding-0">首页</span>
            <span class="pagination-disable">
                <svg xmlns="http://www.w3.org/2000/svg" width="8" viewBox="0 0 8 12" fill="var(--note-color)"><path d="M7.41 1.41L6 0 0 6l6 6 1.41-1.41L2.83 6z" fill-rule="evenodd"/></svg>
            </span>
            {{ end }}
    
            {{ range .PageNumbers }}
            {{ if eq . $.CurrentPage }}
            <span class="pagination-current">{{ . }}</span>
            {{ else }}
            <a class="pagination-number" href="?page={{ . }}{{ $.PageParams }}">{{ . }}</a>
            {{ end }}
            {{ end }}
    
            {{ if lt .CurrentPage .TotalPages }}
            <a class="pagination-number icon-mirror" href="?page={{ add .CurrentPage 1 }}{{ .PageParams }}">
                <svg xmlns="http://www.w3.org/2000/svg" width="8" viewBox="0 0 8 12" fill="currentColor"><path d="M7.41 1.41L6 0 0 6l6 6 1.41-1.41L2.83 6z" fill-rule="evenodd"/></svg>
            </a>
            <a class="pagination-number padding-0" href="?page={{ .TotalPages }}{{ .PageParams }}">尾页</a>
            {{ else }}
            <span class="pagination-disable icon-mirror">
                <svg xmlns="http://www.w3.org/2000/svg" width="8" viewBox="0 0 8 12" fill="var(--note-color)"><path d="M7.41 1.41L6 0 0 6l6 6 1.41-1.41L2.83 6z" fill-rule="evenodd"/></svg>
            </span>
            <span class="pagination-disable padding-0">尾页</span>
            {{ end }}
        </div>
        <form method="get" class="pagination-jump" style="display: inline;">
            <input type="number" name="page" min="1" max="{{ .TotalPages }}" required autocomplete="off">
            <input type="hidden" name="status" value="{{ .Status }}">
            <input type="hidden" name="sort_by" value="{{ .SortBy }}">
            <span class="note-color">( {{ .CurrentPage }} / {{ .TotalPages }} )</span>
        </form>
    </div>
    {{ end }}
</main>
{{ end }}
